$(function(){$('[data-toggle="tooltip"]').tooltip();var e={lines:11,length:5,width:2,radius:5,corners:1,rotate:0,color:"#000",speed:1,trail:50,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%",position:"relative"},t=new Spinner(e);$(window).on("load",function(){var e=$("#user").find(".info").children("span").text(),i="name="+e,o=$("#post-length");$.ajax({type:"GET",url:"/getPostLength",data:i,beforeSend:function(){o.text("");var e=o.get(0);t.spin(e)},success:function(e){$("#post-length").text(e),t.spin()}}),$(".pager").children(".previous").hasClass("disabled")&&$(".pager").children(".next").hasClass("disabled")?$("#pager").hide():$("#pager").show()}),$(window).on("scroll",function(){var e=document.body.scrollTop;e>400?$("#back-top").fadeIn():$("#back-top").fadeOut()}),$("#edit-preview, #post-preview").on("click",function(){var e=$("#edit").val(),t='<div class="sk-cube-grid" style="display: none;"><div class="sk-cube sk-cube1"></div><div class="sk-cube sk-cube2"></div><div class="sk-cube sk-cube3"></div><div class="sk-cube sk-cube4"></div><div class="sk-cube sk-cube5"></div><div class="sk-cube sk-cube6"></div><div class="sk-cube sk-cube7"></div><div class="sk-cube sk-cube8"></div><div class="sk-cube sk-cube9"></div></div>';$("#preview").html(t),e&&$(".sk-cube-grid").show();var i=new Date;$.ajax({type:"GET",url:"/preview",data:{article:e},success:function(e){var t=new Date;if(t-i>1200)$("#preview").html(e);else{var o=1200-(t-i);setTimeout(function(){$("#preview").html(e)},o)}},error:function(e,t,i){console.log(e+t+i)}})}),$(".toggle-star").on("click",function(){var e=$(this),t=document.location.pathname.slice(3);$.ajax({type:"GET",url:"/makeStar",data:{postID:t},success:function(t){e.hide().siblings().show(),alert(t)}})}),$("#thumb-like").one("click",function(){var e=$(this),i=e.siblings("div").text();e.attr("class","glyphicon glyphicon-heart"),$.ajax({type:"GET",url:"/giveLike",data:"",cache:!1,beforeSend:function(){e.siblings("div").text("");var i=e.siblings("div").get(0);t.spin(i)},success:function(o){"Liked"==o?(alert("You have Already Liked, Thanks for your support"),e.siblings("div").text(i),t.spin()):(e.siblings("div").text(o),t.spin())}})}),$("#upload-img").on("click",function(){$("#choose-img").trigger("click")}),$("#choose-img").on("change",function(){$("#submit-img").trigger("click")}),$(".active-login").click(function(){return $("#login").modal(),!1}),$(".active-reg").click(function(){return $("#register").modal(),!1}),$("body").on({click:function(){var e=document.body.scrollTop>400?800:1200;return $("body").animate({scrollTop:0},e),!1}},"#back-top"),$("#reg-account").on("blur",function(){var e="name="+this.value,t=$("#reg-account");$.ajax({type:"GET",url:"/hasAccount",data:e,success:function(e,i){t.val().length<6?t.attr("data-original-title","用户名需大于6位").trigger("mouseover"):e?t.attr("data-original-title","该用户名可使用").trigger("mouseover"):t.attr("data-original-title","该用户名已存在").trigger("mouseover")},error:function(e,t,i){console.log(e+t+i)}})}),$("#log-account").on("blur",function(){var e="name="+this.value,t=$("#log-account").tooltip();$.ajax({type:"GET",url:"/hasAccount",data:e,success:function(e,i){e?t.attr("data-original-title","该用户不存在").trigger("mouseover"):t.attr("data-original-title","该用户可登录").trigger("mouseover")}})}),$("#post-remove").on("click",function(e){var t=confirm("Are you sure to remove this post?");1==t||e.preventDefault()})});